---
interface Heading { depth: number; slug: string; text: string }
const { headings = [] as Heading[] } = Astro.props;
---
<ul class="toc-list">
  {headings.map((h: Heading) => (
    <li class={`toc-h${h.depth}`}>
      <a href={`#${h.slug}`}>{h.text}</a>
    </li>
  ))}
</ul>

<script>
  function initTOC() {
    const tocElements = document.querySelectorAll('.toc');
    tocElements.forEach(toc => {
      const heading = toc.querySelector('.toc-heading');
      if (heading) {
        heading.addEventListener('click', () => {
          toc.classList.toggle('expanded');
        });
      }
    });
  }

  initTOC();
  document.addEventListener('astro:after-swap', initTOC);
</script>
